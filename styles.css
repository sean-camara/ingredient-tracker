/* full mobile-first styles.css */

/* tokens & safe area */
:root{
  --nav-height:72px;
  --nav-gap:16px;
  --bg:#fff7fb;
  --text:#3c2c56;
  --muted:#7f6fb2;
  --accent:#b89bff;
  --accent-2:#ffd6ef;
  --card:#fff0f8;
  --btn:#d6b9ff;
  --btn-hover:#caa2ff;
  --danger:#ffb3b3;
  --shadow: 0 8px 22px rgba(120,86,180,0.12);
}
:root{ --safe-bottom: env(safe-area-inset-bottom, 0px); }

*{box-sizing:border-box}
html,body{height:100%}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Helvetica Neue",Arial;
  background:var(--bg);
  color:var(--text);
  display:flex;
  flex-direction:column;
  min-height:100vh;
  padding-bottom:calc(var(--nav-height) + var(--safe-bottom));
  -webkit-font-smoothing:antialiased;
}

/* search */
input[type="search"]{
  width:calc(100% - 2rem);
  margin:1rem;
  padding:.72rem 1rem;
  border-radius:22px;
  border:1.4px solid rgba(184,155,255,.6);
  background:var(--accent-2);
  font-size:1.05rem;
}

/* filters */
.filters{
  display:flex;
  gap:8px;
  padding:0 1rem 0.6rem;
  justify-content:center;
  align-items:center;
  flex-wrap:wrap;
}
.filters select{
  padding:.5rem .7rem;
  border-radius:14px;
  border:1.2px solid rgba(184,155,255,0.5);
  background: #fff8ff;
  font-weight:700;
}
button.reset{ background:var(--btn); border:none; padding:.5rem .8rem; border-radius:12px; font-weight:800; cursor:pointer; }
.reset:hover{ background:var(--btn-hover); }

/* ingredients list */
#ingredientsList{
  list-style:none;
  padding:0 1rem;
  margin:0;
  width:100%;
  max-width:720px;
  align-self:center;

  /* normalized */
  max-width: 100%;
  width: 100%;
  padding: 0 1rem;
  box-sizing: border-box;
  overflow-wrap: break-word;
  word-break: break-word;
}

/* ---------- CARD GRID LAYOUT ---------- */
/* checkbox | image | content | actions */
.ingredient-item {
  display: grid;
  /* STRONG FIX: allow 1fr column to shrink by using minmax(0,...) */
  grid-template-columns: 40px minmax(0,72px) minmax(0,1fr) 40px;
  grid-template-rows: auto auto auto;
  gap: 8px;
  align-items: center;
  background: var(--card);
  border-radius: 14px;
  padding: 10px;
  margin: 10px 0;
  box-shadow: var(--shadow);

  /* ensure the card itself fits its container and can shrink */
  width: 100%;
  box-sizing: border-box;
  min-width: 0;
  overflow: hidden; /* cosmetic safety */
}

/* checkbox: first column, second row */
.checkbox-cell{ grid-column:1; grid-row:2; display:flex; align-items:center; justify-content:center; }

/* image: second column spanning rows */
.image-cell{ grid-column:2; grid-row:1 / span 3; display:flex; align-items:center; justify-content:center; }
.ingredient-img{ width:64px; height:64px; object-fit:cover; border-radius:12px; border:2px solid rgba(200,170,255,0.6); background:white; }

/* content */
/* Title keeps ellipsis (single-line) */
.title{
  grid-column:3;
  grid-row:1;
  font-weight:800;
  font-size:1rem;
  color:var(--text);

  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
  min-width: 0;
}

/* Quantity & Notes are allowed to wrap / scroll */
.quantity{
  grid-column:3;
  grid-row:2;
  color:var(--muted);
  font-size:.95rem;
  min-width: 0;
  white-space: normal;
}

.notes {
  grid-column: 3;
  grid-row: 3;
  color: #7f6fb2;
  font-size: 0.9rem;
  min-width: 0;

  /* improved wrapping for long/no-space strings */
  overflow-wrap: anywhere;
  word-break: break-word;
  white-space: normal;

  /* contain size & allow internal scroll */
  max-height: 5em;
  overflow-y: auto;
  box-sizing: border-box;
}

/* ensure text children don't push layout */
.title, .quantity, .notes {
  overflow-wrap: break-word;
  word-break: break-word;
  max-width: 100%;
}

/* actions cell */
.actions{ grid-column:4; grid-row:1 / span 3; display:flex; align-items:center; justify-content:center; }
.delete-btn{ background:transparent; border:none; font-size:22px; padding:8px; border-radius:10px; cursor:pointer; }
.delete-btn:hover{ background: rgba(196,61,90,0.06); transform:translateY(-2px); }

/* placeholder thumbnail */
.thumb-placeholder{ width:64px; height:64px; border-radius:12px; display:flex; align-items:center; justify-content:center; background:linear-gradient(180deg,#fff,#f7ecff); color:#a07ee6; font-weight:900; }

.empty-note{ text-align:center; color:var(--muted); padding:18px 12px; }

/* ---------- MODAL ---------- */
.modal-bg{
  position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
  padding:16px calc(1rem + env(safe-area-inset-left)) calc((var(--nav-height) + var(--nav-gap)) + var(--safe-bottom));
  background: rgba(86,56,142,0.22);
  z-index:999;
  visibility:hidden; opacity:0; transition:opacity .28s ease, visibility .28s ease;
}
.modal-bg.active{ visibility:visible; opacity:1; }

#modal, .modal{
  width:100%; max-width:520px; background:white; border-radius:18px; padding:14px;
  box-shadow:0 12px 30px rgba(120,86,180,0.14);
  max-height: calc(100vh - (var(--nav-height) + var(--nav-gap) + var(--safe-bottom) + 40px));
  overflow:auto; -webkit-overflow-scrolling:touch;
}
#modal:after{ content:''; display:block; height:14px; } /* breathing room */

#modal h2{text-align:center; margin:6px 0 10px; color:var(--accent); font-weight:800;}

/* form fields */
#modal label{ display:block; margin-top:8px; font-weight:700; }
#modal input[type="text"], #modal input[type="date"], #modal select, #modal textarea{
  width:100%; padding:.6rem .8rem; margin-top:.4rem; border-radius:12px; border:1.4px solid rgba(184,155,255,0.6); background:#fff8ff; font-weight:700;
}
.file-label{ display:inline-block; margin-top:.8rem; background:var(--btn); color:var(--text); padding:.5rem .9rem; border-radius:14px; font-weight:800; cursor:pointer; box-shadow:0 6px 12px rgba(184,155,255,0.12); }
.file-label:hover{ background:var(--btn-hover); }
#imagePreview{ width:100%; max-height:160px; object-fit:contain; border-radius:12px; margin-top:8px; }

/* modal buttons */
.modal-buttons{ display:flex; gap:10px; margin-top:12px; justify-content:space-between; flex-wrap:wrap; }
.save-btn{ background:var(--accent); color:white; border:none; padding:.7rem 1rem; border-radius:12px; font-weight:800; flex:1; min-width:120px; cursor:pointer; }
.cancel-btn{ background:var(--accent-2); color:var(--text); border:none; padding:.7rem 1rem; border-radius:12px; font-weight:800; flex:1; min-width:120px; cursor:pointer; }
.clear-btn{ background:var(--danger); color:#800; border:none; padding:.7rem 1rem; border-radius:12px; font-weight:800; }

/* constrain the textarea inside modal so modal doesn't grow too large */
#modal textarea {
  max-height: 18vh;
  min-height: 4.2rem;
  resize: vertical;
  overflow-y: auto;
}

/* ---------- BOTTOM NAV ---------- */
#bottomNav{
  position:fixed; bottom:calc(8px + var(--safe-bottom)); left:8px; right:8px; height:var(--nav-height);
  display:flex; justify-content:space-around; align-items:center; border-radius:16px; padding:8px;
  background: linear-gradient(180deg, rgba(214,185,255,0.92), rgba(255,214,240,0.96)); box-shadow:var(--shadow); z-index:1000;
}
#bottomNav button{ background:none; border:none; color:var(--text); font-weight:800; display:flex; flex-direction:column; align-items:center; gap:4px; padding:6px 12px; border-radius:10px; }
#bottomNav button.active{ color:var(--accent); transform:translateY(-3px); }

/* focus styles */
button:focus, input:focus, select:focus, textarea:focus{ outline:3px solid rgba(168,120,255,0.16); outline-offset:2px; border-radius:8px; }

@media(min-width:640px){
  input[type="search"]{ max-width:560px; }
  #ingredientsList{ max-width:640px; }
}

.ingredient-card.bought {
  background-color: #d4edda; /* pale green */
  color: #155724; /* darker green text */
  border: 1px solid #c3e6cb;
}

/* Hide the "Bought" message label */
.bought-label {
  display: none !important;
}

/* Keep green card styling for bought items */
.ingredient-item.bought {
  background-color: #d4edda; /* pale green background */
  color: #155724; /* darker green text */
  border: 1px solid #c3e6cb;
}

.bought-checkbox {
    accent-color: initial !important;
}
